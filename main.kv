WindowManager:

    MainMenu:

    Authorization:

    CharacterBoard:

    DatabaseManager:
    CreateRace:
    CreateProfession:
    CreateSex:
    CreateStarSign:


<BoxLayout>:
    orientation: "vertical"
    size: root.width, root.height
    padding: 5
    spacing: 5
<GridLayout>:
    cols: 1
<TextInput>:
    font_size: 14
<Label>:
    font_size: 14
<PopupBox>:
    text: "%s"%root.textContent


<MainMenu>:
    name: "Main"

    BoxLayout:

        BoxLayout:
            size_hint: (1, .1)
            orientation: "horizontal"
            canvas.before:
                Color:
                    rgba: (128/255,128/255,128/255,1)
                Rectangle:
                    size: self.size
                    pos: self.pos
            Label:
                halign: 'center'
                valign: 'middle'
                text_size: self.size
                size_hint_x: .5
                text: root.text
            PrimaryButton:
                text: "Manage" if (root.text != '') else ''
                size_hint_x: .25
                opacity: 1 if (root.text != '') else 0
                disabled: False if (root.text != '') else True
                on_release:
                    root.logout() if (root.text != '') else root.changeScreen("Authorization")
                    root.manager.transition.direction = "down"
            PrimaryButton:
                text: "Log Out" if (root.text != '') else "Log In"
                size_hint_x: .25
                on_release:
                    root.logout() if (root.text != '') else root.changeScreen("Authorization")
                    root.manager.transition.direction = "down"
        BoxLayout:
            size_hint: (1,.9)

            canvas.before:
                Color:
                    rgba: (128/255,128/255,128/255,1)
                Rectangle:
                    size: self.size
                    pos: self.pos

            Label:
                text: 'Warhammer\nHelper'
                halign: 'center'
                valign: 'middle'
                text_size: self.size
                bold: True
                font_size: 32

                style: 'bold'
            PrimaryButton:
                text: "New"
            PrimaryButton:
                text: "Roll"
            PrimaryButton:
                text: "Character board"
                on_release:
                    app.root.current = "CharacterBoard"
                    root.manager.transition.direction = "down"
            PrimaryButton:
                opacity: 0 if root.manager.admin == '' else 1
                disabled: 1 if root.manager.admin == '' else 0
                text: "Admin Panel"
                on_release:
                    app.root.current = "DbManager"
                    root.manager.transition.direction = "down"

<Authorization>:
    name: "Authorization"

    loginEmail: loginEmail
    loginPassword: loginPassword
    registerEmail: registerEmail
    registerPassword: registerPassword
    registerPasswordConfirm: registerPasswordConfirm
    BoxLayout:
        orientation: "horizontal"
        size_hint: (.8, .8)
        pos_hint: {'center_x': .5, 'center_y': .5}

        BoxLayout:
            canvas.before:
                Color:
                    rgba: (128/255,128/255,128/255,1)
                Rectangle:
                    size: self.size
                    pos: self.pos

            Label:
                text: "Log in"
                font_size: 46
                text_size: self.size
                halign: 'center'
                valign: 'middle'
                size_hint: (1,0.2)

            GridLayout:
                cols:2

                SmallLabel:
                    text: "Email:"
                    size_hint_x: .3
                SmallTextInput:
                    id: loginEmail
                    size_hint_x: .8

                SmallLabel:
                    text: "Password:"
                SmallTextInput:
                    id: loginPassword
                    allow_copy: False
                    password: True

            SubmitButton:
                text: "Submit"
                size_hint: (0.4, 0.2)
                pos_hint: {'center_x': 0.5}
                on_release:
                    app.root.current = "Main" if root.submitLogin() else "AccountCreation"


        BoxLayout:
            canvas.before:
                Color:
                    rgba: (128/255,128/255,128/255,1)
                Rectangle:
                    size: self.size
                    pos: self.pos

            Label:
                text: "Register"
                font_size: 46
                text_size: self.size
                halign: 'center'
                valign: 'middle'
                size_hint: (1,0.2)

            GridLayout:
                cols:2

                SmallLabel:
                    text: "Email:"
                    size_hint_x: .3
                SmallTextInput:
                    id: registerEmail
                    size_hint_x: .8

                SmallLabel:
                    text: "Password:"
                SmallTextInput:
                    id: registerPassword
                    allow_copy: False
                    password: True

                SmallLabel:
                    text: "Confirm password:"
                SmallTextInput:
                    id: registerPasswordConfirm
                    allow_copy: False
                    password: True

            SubmitButton:
                text: "Submit"
                size_hint: (0.4, 0.2)
                pos_hint: {'center_x': 0.5}
                on_release:
                    root.submitRegister()

    BoxLayout:
        orientation: "vertical"
        size_hint: (1, 1)

        PrimaryButton:
            text: "Back"
            size_hint: (None, None)
            height: 50
            width: 100
            on_release:
                app.root.current = "Main"
                root.manager.transition.direction = "up"
        Widget:


<CharacterBoard>:
    name: "CharacterBoard"

    layout: layout

    ScrollView:
        size_hint: 1, 1
        BoxLayout:
            id: layout
            orientation: 'vertical'
            size_hint: 1, None
            height: sum(x.height+5 for x in self.children)-65 if root.openedTimes != 2 else sum(x.height+5 for x in self.children)
            bind: root.refresh()

            PrimaryButton:
                text: "Back"
                size_hint: 1, None
                height: 30
                on_release:
                    root.refresh()
                    app.root.current = "Main"


<DatabaseManager>:
    name: "DbManager"

    BoxLayout:

        Label:
            text: "Database Manager"
            font_size: 46
            text_size: self.size
            halign: 'center'
            valign: 'middle'
            size_hint: (1,0.1)

        GridLayout:
            cols: 3
            size_hint: (1,0.9)

            PrimaryButton:
                text: "Create Race"
                font_size: 32
                on_release:
                    app.root.current = "CRace"
                    root.manager.transition.direction = "left"

            PrimaryButton:
                text: "Create Profession"
                font_size: 32
                on_release:
                    app.root.current = "CProfession"
                    root.manager.transition.direction = "left"

            PrimaryButton:
                text: "Create Sex"
                font_size: 32
                on_release:
                    app.root.current = "CSex"
                    root.manager.transition.direction = "left"

            PrimaryButton:
                text: "Create Star sign"
                font_size: 32
                on_release:
                    app.root.current = "CStarSign"
                    root.manager.transition.direction = "left"


<CreateRace>:
    name: "CRace"

    nameOfRace: nameOfRace
    description: description
    primaryStatistics: primaryStatistics
    secondaryStatistics: secondaryStatistics
    wRoll: wRoll
    fpRoll: fpRoll

    BoxLayout:

        GridLayout:
            cols: 2
            size_hint: (1,0.8)

            SmallLabel:
                text: "Name"
            SmallTextInput:
                id: nameOfRace

            BigLabel:
                text: "Description"
            BigTextInput:
                id: description

            SmallLabel:
                text: "Primary statistics"
            SmallTextInput:
                id: primaryStatistics
                hint_text: '0000000000000000'

            SmallLabel:
                text: "Secondary statistics"
            SmallTextInput:
                id: secondaryStatistics
                hint_text: '0000000000000000'

            SmallLabel:
                text: "Vitality roll"
            SmallTextInput:
                id: wRoll
                hint_text: '00000000'

            SmallLabel:
                text: "Fate points roll"
            SmallTextInput:
                id: fpRoll
                hint_text: '000'

        SubmitButton:
            text: "Submit"
            pos_hint: {'center_x': 0.5}
            size_hint: (.2,.1)
            on_release:
                root.press()

        PrimaryButton:
            text: "Go back"
            size_hint: (.2,.1)
            on_release:
                app.root.current = "DbManager"
                root.manager.transition.direction = "right"


<CreateProfession>:
    name: "CProfession"

    nameOfProfession: nameOfProfession
    description: description
    availableFor: availableFor
    primaryStatistics: primaryStatistics
    secondaryStatistics: secondaryStatistics
    equipment: equipment
    weapon: weapon
    armor: armor

    BoxLayout:

        GridLayout:
            cols: 2
            size_hint: (1,0.8)

            SmallLabel:
                text: "Name"
            SmallTextInput:
                id: nameOfProfession

            BigLabel:
                text: "Description"
            BigTextInput:
                id: description
                multiline: True

            SmallLabel:
                text: "Available for"
            SmallTextInput:
                id: availableFor
                hint_text: '0000'

            SmallLabel:
                text: "Primary statistics"
            SmallTextInput:
                id: primaryStatistics
                hint_text: '0000000000000000'

            SmallLabel:
                text: "Secondary statistics"
            SmallTextInput:
                id: secondaryStatistics
                hint_text: '0000000000000000'

            SmallLabel:
                text: "Equipment"
            SmallTextInput:
                id: equipment

            SmallLabel:
                text: "Weapon"
            SmallTextInput:
                id: weapon

            SmallLabel:
                text: "Armor"
            SmallTextInput:
                id: armor

        SubmitButton:
            text: "Submit"
            pos_hint: {'center_x': 0.5}
            on_press: root.press()

        PrimaryButton:
            text: "Go back"
            on_release:
                app.root.current = "DbManager"
                root.manager.transition.direction = "right"


<CreateSex>:
    name: "CSex"

    nameOfSex: nameOfSex

    BoxLayout:

        GridLayout:
            cols: 2
            size_hint: (1,0.8)

            SmallLabel:
                text: "Name"
                size_hint_x: .2
            SmallTextInput:
                id: nameOfSex
                size_hint_x: .8

        SubmitButton:
            text: "Submit"
            pos_hint: {'center_x': 0.5}
            size_hint: (.2,.1)
            on_press: root.press()

        PrimaryButton:
            text: "Go back"
            size_hint: (.2,.1)
            on_release:
                app.root.current = "DbManager"
                root.manager.transition.direction = "right"


<CreateStarSign>:
    name: "CStarSign"

    nameOfStarSign: nameOfStarSign
    description: description

    BoxLayout:

        GridLayout:
            cols: 2
            size_hint: (1,0.8)

            SmallLabel:
                text: "Name"
            SmallTextInput:
                id: nameOfStarSign

            BigLabel:
                text: "Description"
            BigTextInput:
                id: description

        SubmitButton:
            text: "Submit"
            pos_hint: {'center_x': 0.5}
            size_hint: (.2,.1)
            on_press: root.press()

        PrimaryButton:
            text: "Go back"
            size_hint: (.2,.1)
            on_release:
                app.root.current = "DbManager"
                root.manager.transition.direction = "right"

